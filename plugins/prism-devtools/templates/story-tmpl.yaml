# <!-- Powered by PRISMâ„¢ System -->
template:
  id: user-story-template-v1
  name: User Story Document
  version: 1.0
  output:
    format: markdown
    filename: docs/stories/{{story_id}}-{{story_slug}}.md
    title: "Story {{story_id}}: {{story_title}}"

workflow:
  mode: interactive
  elicitation: advanced-elicitation

agent_config:
  editable_sections:
    - Status
    - User Story
    - Acceptance Criteria
    - Tasks
    - Dev Notes
    - Change Log

sections:
  - id: story-header
    title: Story Header
    type: markdown
    template: |
      # {{story_title}}

      ## Description

      {{story_description}}
    instruction: Generate the story title and a brief description paragraph
    owner: product-owner
    editors: [product-owner, scrum-master]

  - id: story-metadata
    title: Metadata
    type: markdown-table
    template: |
      | Field | Value |
      |-------|-------|
      | **Story ID** | {{story_id}} |
      | **Status** | {{status}} |
      | **Priority** | {{priority}} |
      | **Story Points** | {{story_points}} |
      | **Sprint** | {{sprint}} |
      | **Created** | {{created_date}} |
      | **Owner** | {{owner}} |
    instruction: Fill in story metadata
    owner: product-owner
    editors: [product-owner, scrum-master]

  - id: status
    title: Status
    type: choice
    choices: [Backlog, Ready, InProgress, Review, Testing, Done]
    instruction: Select the current status of the story
    owner: scrum-master
    editors: [scrum-master, dev-agent]

  - id: user-story
    title: User Story
    type: template-text
    template: |
      **As a** {{persona}},
      **I want to** {{action}},
      **so that** {{benefit}}.
    instruction: Define the user story using the standard format with persona, action, and benefit
    elicit: true
    owner: product-owner
    editors: [product-owner]

  - id: acceptance-criteria
    title: Acceptance Criteria
    type: numbered-list
    instruction: |
      Define acceptance criteria using Given/When/Then format or clear numbered criteria:
      1. Given [context], When [action], Then [expected outcome]
      2. [Specific measurable criteria]
    elicit: true
    owner: product-owner
    editors: [product-owner, scrum-master]

  - id: assumptions
    title: Assumptions
    type: bullet-list
    instruction: List any assumptions made about the story
    elicit: true
    owner: product-owner
    editors: [product-owner, scrum-master]

  - id: dependencies
    title: Dependencies
    type: bullet-list
    instruction: List any dependencies (other stories, technical requirements, etc.)
    owner: product-owner
    editors: [product-owner, scrum-master]

  - id: definition-of-done
    title: Definition of Done
    type: checklist
    instruction: |
      Standard DoD criteria that must be met before story is considered complete.
      All items must be checked before moving story to Done status.
    template: |
      - [ ] All acceptance criteria met and validated
      - [ ] All tasks completed
      - [ ] Code implemented following PRISM principles
      - [ ] Unit tests written and passing
      - [ ] Integration tests passing
      - [ ] Code reviewed and approved
      - [ ] QA testing completed and passed
      - [ ] Documentation updated
      - [ ] No regression in existing functionality
      - [ ] Performance requirements met
      - [ ] Security requirements validated
      - [ ] Deployed to staging/production
    owner: scrum-master
    editors: [scrum-master, dev-agent, qa-agent]

  - id: tasks
    title: Tasks
    type: bullet-list
    instruction: |
      Break down the story into specific implementation tasks.
      Each task should reference applicable acceptance criteria.
      Tasks will be created as separate task documents.
    template: |
      - [ ] Task 1: {{task_description}} (AC: #)
      - [ ] Task 2: {{task_description}} (AC: #)
      - [ ] Task 3: {{task_description}} (AC: #)
    elicit: true
    owner: scrum-master
    editors: [scrum-master, dev-agent]

  - id: technical-notes
    title: Technical Notes
    instruction: |
      Relevant technical information for implementation:
      - Architecture patterns to follow
      - APIs/services involved
      - Database changes needed
      - Security considerations
      - Performance requirements
    elicit: true
    owner: scrum-master
    editors: [scrum-master, dev-agent]

  - id: testing-requirements
    title: Testing Requirements
    instruction: |
      - Test types needed (unit, integration, e2e)
      - Test coverage expectations
      - Performance testing needs
      - Security testing needs
    owner: qa-agent
    editors: [qa-agent, scrum-master]

  - id: psp-estimation
    title: PSP Estimation (PROBE Method)
    instruction: Estimation data using PROBE method from PSP
    owner: scrum-master
    editors: [scrum-master, dev-agent]
    sections:
      - id: estimation
        title: Estimation
        template: |
          - Story Points: {{1|2|3|5|8|13}}
          - Size Category: {{very_small|small|medium|large|very_large}}
          - Similar Stories: {{list_of_proxies}}
          - Estimated Hours: {{optimistic}}-{{likely}}-{{pessimistic}}
          - Confidence: {{high|medium|low}}
          - Estimation Date: {{date}}
        instruction: PROBE-based estimation (points map: 1=VS, 2=S, 3=M, 5=L, 8=VL, 13=VL+)
        owner: scrum-master
        editors: [scrum-master]

      - id: tracking
        title: Tracking
        template: |
          - Started: {{start_date_time}}
          - Completed: {{end_date_time}}
          - Actual Hours: {{calculated_hours}}
          - Estimation Accuracy: {{variance_percentage}}
        instruction: Track actual times for continuous improvement
        owner: dev-agent
        editors: [dev-agent]

  - id: change-log
    title: Change Log
    type: table
    columns: [Date, Version, Description, Author]
    instruction: Track changes made to this story document
    owner: scrum-master
    editors: [scrum-master, dev-agent, qa-agent, product-owner]

  - id: implementation-record
    title: Implementation Record
    instruction: Populated by dev agent during implementation
    owner: dev-agent
    editors: [dev-agent]
    sections:
      - id: tasks-created
        title: Tasks Created
        instruction: List all task documents created from this story
        owner: dev-agent
        editors: [dev-agent]

      - id: files-modified
        title: Files Modified
        instruction: List all files created or modified during implementation
        owner: dev-agent
        editors: [dev-agent]

      - id: completion-notes
        title: Completion Notes
        instruction: Notes about implementation, challenges, decisions
        owner: dev-agent
        editors: [dev-agent]

  - id: qa-results
    title: QA Results
    instruction: Results from QA review of the completed story
    owner: qa-agent
    editors: [qa-agent]
